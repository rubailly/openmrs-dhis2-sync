2023-12-07 12:45:11,686 - INFO - Logging is set up.
2023-12-07 12:45:15,666 - INFO - Attempting to connect to the OpenMRS database...
2023-12-07 12:45:16,748 - INFO - package: mysql.connector.plugins
2023-12-07 12:45:16,749 - INFO - plugin_name: mysql_native_password
2023-12-07 12:45:16,750 - INFO - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2023-12-07 12:45:17,270 - INFO - Connected to the OpenMRS database at 41.74.172.73 successfully.
2023-12-07 12:45:17,270 - INFO - Connection to OpenMRS database successful. Fetching encounters by location ID and encounter type IDs...
2023-12-07 12:45:18,281 - INFO - Fetched encounters for 1278 patients from the OpenMRS database for location ID 366.
2023-12-07 12:45:18,284 - INFO - Logged encounters for 1278 patients to encounters_to_process.json.
2023-12-07 12:45:18,292 - INFO - Processing encounters for patient ID: 247616
2023-12-07 12:45:19,106 - ERROR - No patient data found for patient ID 714593
2023-12-07 12:45:19,106 - INFO - Fetching observations for encounter ID: 714593
2023-12-07 12:45:19,106 - INFO - Fetching observations for encounter ID: 714593
2023-12-07 12:45:19,849 - INFO - Fetched 9 observations for encounter ID: 714593
2023-12-07 12:45:19,849 - INFO - Fetched 9 observations for encounter ID: 714593
2023-12-07 12:45:20,267 - ERROR - Failed to fetch or transform observations for encounter ID 714593: 'observations'
2023-12-07 12:45:20,267 - ERROR - Failed to fetch encounters by location ID: 'NoneType' object has no attribute 'get'
2023-12-07 12:57:14,182 - INFO - Logging is set up.
2023-12-07 12:57:17,451 - INFO - Attempting to connect to the OpenMRS database...
2023-12-07 12:57:19,794 - INFO - package: mysql.connector.plugins
2023-12-07 12:57:19,794 - INFO - plugin_name: mysql_native_password
2023-12-07 12:57:19,794 - INFO - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2023-12-07 12:57:19,861 - INFO - Connected to the OpenMRS database at 41.74.172.73 successfully.
2023-12-07 12:57:19,861 - INFO - Connection to OpenMRS database successful. Fetching encounters by location ID and encounter type IDs...
2023-12-07 12:57:20,119 - INFO - Fetched encounters for 1278 patients from the OpenMRS database for location ID 366.
2023-12-07 12:57:20,122 - INFO - Logged encounters for 1278 patients to encounters_to_process.json.
2023-12-07 12:57:20,130 - INFO - Processing encounters for patient ID: 247616
2023-12-07 12:57:20,239 - INFO - Fetching observations for encounter ID: 714593
2023-12-07 12:57:20,239 - INFO - Fetching observations for encounter ID: 714593
2023-12-07 12:57:20,333 - INFO - Fetched 9 observations for encounter ID: 714593
2023-12-07 12:57:20,333 - INFO - Fetched 9 observations for encounter ID: 714593
2023-12-07 12:57:20,409 - ERROR - Failed to fetch or transform observations for encounter ID 714593: 'observations'
2023-12-07 12:57:20,410 - ERROR - Failed to fetch encounters by location ID: 'location'
2023-12-07 14:11:35,953 - INFO - Logging is set up.
2023-12-07 14:11:39,195 - INFO - Attempting to connect to the OpenMRS database...
2023-12-07 14:11:39,767 - INFO - package: mysql.connector.plugins
2023-12-07 14:11:39,767 - INFO - plugin_name: mysql_native_password
2023-12-07 14:11:39,767 - INFO - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2023-12-07 14:11:39,845 - INFO - Connected to the OpenMRS database at 41.74.172.73 successfully.
2023-12-07 14:11:39,845 - INFO - Connection to OpenMRS database successful. Fetching encounters by location ID and encounter type IDs...
2023-12-07 14:11:40,235 - INFO - Fetched encounters for 1278 patients from the OpenMRS database for location ID 366.
2023-12-07 14:11:40,237 - INFO - Logged encounters for 1278 patients to encounters_to_process.json.
2023-12-07 14:11:40,245 - INFO - Processing encounters for patient ID: 247616
2023-12-07 14:11:40,464 - INFO - Fetching observations for encounter ID: 714593
2023-12-07 14:11:40,464 - INFO - Fetching observations for encounter ID: 714593
2023-12-07 14:11:40,715 - INFO - Fetched 9 observations for encounter ID: 714593
2023-12-07 14:11:40,715 - INFO - Fetched 9 observations for encounter ID: 714593
2023-12-07 14:11:40,807 - ERROR - Failed to fetch or transform observations for encounter ID 714593: 'observations'
2023-12-07 14:11:40,807 - ERROR - Failed to fetch encounters by location ID: 'location'
2023-12-07 14:18:34,725 - INFO - Logging is set up.
2023-12-07 14:18:37,675 - INFO - Attempting to connect to the OpenMRS database...
2023-12-07 14:18:37,868 - INFO - package: mysql.connector.plugins
2023-12-07 14:18:37,868 - INFO - plugin_name: mysql_native_password
2023-12-07 14:18:37,869 - INFO - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2023-12-07 14:18:37,986 - INFO - Connected to the OpenMRS database at 41.74.172.73 successfully.
2023-12-07 14:18:37,986 - INFO - Connection to OpenMRS database successful. Fetching encounters by location ID and encounter type IDs...
2023-12-07 14:18:38,396 - INFO - Fetched encounters for 1278 patients from the OpenMRS database for location ID 366.
2023-12-07 14:18:38,399 - INFO - Logged encounters for 1278 patients to encounters_to_process.json.
2023-12-07 14:18:38,407 - INFO - Processing encounters for patient ID: 247616
2023-12-07 14:18:38,515 - INFO - Fetching observations for encounter ID: 714593
2023-12-07 14:18:38,516 - INFO - Fetching observations for encounter ID: 714593
2023-12-07 14:18:38,660 - INFO - Fetched 9 observations for encounter ID: 714593
2023-12-07 14:18:38,660 - INFO - Fetched 9 observations for encounter ID: 714593
2023-12-07 14:18:38,763 - INFO - Fetched form ID: 197 for encounter ID: 714593
2023-12-07 14:18:38,764 - ERROR - Failed to fetch or transform observations for encounter ID 714593: 'observations'
2023-12-07 14:18:38,764 - ERROR - Failed to fetch encounters by location ID: 'location'
2023-12-07 14:24:36,173 - INFO - Logging is set up.
2023-12-07 14:24:39,040 - INFO - Attempting to connect to the OpenMRS database...
2023-12-07 14:24:40,254 - INFO - package: mysql.connector.plugins
2023-12-07 14:24:40,255 - INFO - plugin_name: mysql_native_password
2023-12-07 14:24:40,255 - INFO - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2023-12-07 14:24:40,363 - INFO - Connected to the OpenMRS database at 41.74.172.73 successfully.
2023-12-07 14:24:40,363 - INFO - Connection to OpenMRS database successful. Fetching encounters by location ID and encounter type IDs...
2023-12-07 14:24:40,727 - INFO - Fetched encounters for 1278 patients from the OpenMRS database for location ID 366.
2023-12-07 14:24:40,730 - INFO - Logged encounters for 1278 patients to encounters_to_process.json.
2023-12-07 14:24:40,738 - INFO - Processing encounters for patient ID: 247616
2023-12-07 14:24:40,906 - INFO - Fetching observations for encounter ID: 714593
2023-12-07 14:24:40,907 - INFO - Fetching observations for encounter ID: 714593
2023-12-07 14:24:41,415 - INFO - Fetched 9 observations for encounter ID: 714593
2023-12-07 14:24:41,415 - INFO - Fetched 9 observations for encounter ID: 714593
2023-12-07 14:24:41,473 - INFO - Fetched form ID: 197 for encounter ID: 714593
2023-12-07 14:24:41,474 - ERROR - Failed to fetch or transform observations for encounter ID 714593: 'observations'
2023-12-07 14:24:41,474 - ERROR - Failed to fetch encounters by location ID: 'location'
2023-12-07 14:25:04,975 - INFO - Logging is set up.
2023-12-07 14:25:07,695 - INFO - Attempting to connect to the OpenMRS database...
2023-12-07 14:25:07,874 - INFO - package: mysql.connector.plugins
2023-12-07 14:25:07,874 - INFO - plugin_name: mysql_native_password
2023-12-07 14:25:07,875 - INFO - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2023-12-07 14:25:07,951 - INFO - Connected to the OpenMRS database at 41.74.172.73 successfully.
2023-12-07 14:25:07,951 - INFO - Connection to OpenMRS database successful. Fetching encounters by location ID and encounter type IDs...
2023-12-07 14:25:08,273 - INFO - Fetched encounters for 1278 patients from the OpenMRS database for location ID 366.
2023-12-07 14:25:08,276 - INFO - Logged encounters for 1278 patients to encounters_to_process.json.
2023-12-07 14:25:08,284 - INFO - Processing encounters for patient ID: 247616
2023-12-07 14:25:08,346 - INFO - Fetching observations for encounter ID: 714593
2023-12-07 14:25:08,346 - INFO - Fetching observations for encounter ID: 714593
2023-12-07 14:25:08,414 - INFO - Fetched 9 observations for encounter ID: 714593
2023-12-07 14:25:08,415 - INFO - Fetched 9 observations for encounter ID: 714593
2023-12-07 14:25:08,483 - INFO - Fetched form ID: 197 for encounter ID: 714593
2023-12-07 14:25:08,484 - ERROR - Failed to fetch or transform observations for encounter ID 714593: 'observations'
2023-12-07 14:25:08,484 - ERROR - Failed to fetch encounters by location ID: 'location'
2023-12-07 18:57:37,408 - INFO - Logging is set up.
2023-12-07 18:57:39,950 - INFO - Attempting to connect to the OpenMRS database...
2023-12-07 18:57:40,178 - INFO - package: mysql.connector.plugins
2023-12-07 18:57:40,178 - INFO - plugin_name: mysql_native_password
2023-12-07 18:57:40,179 - INFO - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2023-12-07 18:57:40,283 - INFO - Connected to the OpenMRS database at 41.74.172.73 successfully.
2023-12-07 18:57:40,283 - INFO - Connection to OpenMRS database successful. Fetching encounters by location ID and encounter type IDs...
2023-12-07 18:57:40,593 - INFO - Fetched encounters for 1278 patients from the OpenMRS database for location ID 366.
2023-12-07 18:57:40,596 - INFO - Logged encounters for 1278 patients to encounters_to_process.json.
2023-12-07 18:57:40,604 - INFO - Processing encounters for patient ID: 247616
2023-12-07 18:57:40,695 - INFO - Fetching observations for encounter ID: 714593
2023-12-07 18:57:40,695 - INFO - Fetching observations for encounter ID: 714593
2023-12-07 18:57:40,824 - INFO - Fetched 9 observations for encounter ID: 714593
2023-12-07 18:57:40,825 - INFO - Fetched 9 observations for encounter ID: 714593
2023-12-07 18:57:40,934 - INFO - Fetched form ID: 197 for encounter ID: 714593
2023-12-07 18:57:40,935 - ERROR - Failed to fetch or transform observations for encounter ID 714593: 'observations'
2023-12-07 18:57:40,935 - ERROR - Failed to fetch encounters by location ID: 'location'
2023-12-07 18:59:42,135 - INFO - Logging is set up.
2023-12-07 18:59:44,970 - INFO - Attempting to connect to the OpenMRS database...
2023-12-07 18:59:46,595 - INFO - package: mysql.connector.plugins
2023-12-07 18:59:46,596 - INFO - plugin_name: mysql_native_password
2023-12-07 18:59:46,597 - INFO - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2023-12-07 18:59:46,692 - INFO - Connected to the OpenMRS database at 41.74.172.73 successfully.
2023-12-07 18:59:46,692 - INFO - Connection to OpenMRS database successful. Fetching encounters by location ID and encounter type IDs...
2023-12-07 18:59:47,025 - INFO - Fetched encounters for 1278 patients from the OpenMRS database for location ID 366.
2023-12-07 18:59:47,027 - INFO - Logged encounters for 1278 patients to encounters_to_process.json.
2023-12-07 18:59:47,035 - INFO - Processing encounters for patient ID: 247616
2023-12-07 18:59:47,101 - INFO - Fetching observations for encounter ID: 714593
2023-12-07 18:59:47,102 - INFO - Fetching observations for encounter ID: 714593
2023-12-07 18:59:47,196 - INFO - Fetched 9 observations for encounter ID: 714593
2023-12-07 18:59:47,196 - INFO - Fetched 9 observations for encounter ID: 714593
2023-12-07 18:59:47,282 - INFO - Fetched form ID: 197 for encounter ID: 714593
2023-12-07 18:59:47,283 - ERROR - Failed to fetch or transform observations for encounter ID 714593: 'observations'
2023-12-07 18:59:47,283 - ERROR - Failed to fetch encounters by location ID: name 'logging' is not defined
2023-12-07 19:03:00,183 - INFO - Logging is set up.
2023-12-07 19:03:02,661 - INFO - Attempting to connect to the OpenMRS database...
2023-12-07 19:03:02,799 - INFO - package: mysql.connector.plugins
2023-12-07 19:03:02,800 - INFO - plugin_name: mysql_native_password
2023-12-07 19:03:02,801 - INFO - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2023-12-07 19:03:02,906 - INFO - Connected to the OpenMRS database at 41.74.172.73 successfully.
2023-12-07 19:03:02,906 - INFO - Connection to OpenMRS database successful. Fetching encounters by location ID and encounter type IDs...
2023-12-07 19:03:03,274 - INFO - Fetched encounters for 1278 patients from the OpenMRS database for location ID 366.
2023-12-07 19:03:03,277 - INFO - Logged encounters for 1278 patients to encounters_to_process.json.
2023-12-07 19:03:03,285 - INFO - Processing encounters for patient ID: 247616
2023-12-07 19:03:03,372 - INFO - Fetching observations for encounter ID: 714593
2023-12-07 19:03:03,373 - INFO - Fetching observations for encounter ID: 714593
2023-12-07 19:03:03,493 - INFO - Fetched 9 observations for encounter ID: 714593
2023-12-07 19:03:03,494 - INFO - Fetched 9 observations for encounter ID: 714593
2023-12-07 19:03:03,564 - INFO - Fetched form ID: 197 for encounter ID: 714593
2023-12-07 19:03:03,564 - INFO - Starting transformation of OpenMRS observations for encounter ID: 714593
2023-12-07 19:03:03,565 - ERROR - Error during transformation of OpenMRS observations for encounter ID 714593: 'observations'
Traceback (most recent call last):
  File "/home/rbailly/eclipse-workspace/medtronic/openmrsdhis2sync/openmrs-dhis2-sync/src/services/sync_service.py", line 41, in _transform_openmrs_to_dhis2_encounter
    dhis2_data_element_id = form_mappings['observations'].get(concept_uuid)
KeyError: 'observations'
2023-12-07 19:03:03,565 - INFO - Transformed encounter data for encounter ID: 714593
2023-12-07 19:03:03,565 - INFO - Starting transformation of OpenMRS patient data: {'patient_id': 247616, 'given_name': 'Edouard', 'middle_name': None, 'family_name': 'RUTAYISIRE', 'gender': 'M', 'birthdate': '1975-01-01'}
2023-12-07 19:03:03,565 - ERROR - Error during transformation of OpenMRS patient data: 'location'
Traceback (most recent call last):
  File "/home/rbailly/eclipse-workspace/medtronic/openmrsdhis2sync/openmrs-dhis2-sync/src/services/sync_service.py", line 67, in _transform_openmrs_to_dhis2_patient
    dhis2_org_unit_id = self.mappings['location'].get(location_id)
KeyError: 'location'
2023-12-07 19:03:03,566 - INFO - Transformed patient data: {
    "encounters": [
        {}
    ]
}
